# üî¨ –ü–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä Python-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤ mtDNA

## `python` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –Ω–æ–≤–∏—á–∫–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å—Ç–∏–ª—å –∏ –≥–ª—É–±–∏–Ω—É –æ–±—ä—è—Å–Ω–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —Å–¥–µ–ª–∞–Ω—ã –¥–ª—è R-–≤–µ—Ä—Å–∏–∏, –Ω–æ –¥–ª—è Python-–∫–æ–¥–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç Python-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
2. –ì–¥–µ –ª–µ–∂–∞—Ç –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `python/`)
3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
4. –ö–ª—é—á–µ–≤—ã–µ –º–æ–¥—É–ª–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî —Ä–∞–∑–±–æ—Ä –ø–æ —Ñ–∞–π–ª–∞–º
   - `run_compare_pos8473.py`
   - `src/analysis.py`
   - `src/io.py`
   - `src/main.py`
   - `src/r_integration.py`
   - `src/viz.py`
5. –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–æ—à–∞–≥–æ–≤—ã–π –ø–∞–π–ø–ª–∞–π–Ω (–∫–∞–∫ –∫–æ–¥ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç)
6. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ª–æ–≥–∏–∫–∞ (EffectiveLength, self-overlap, nested removal)
7. –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è –∏ —É—Å–∫–æ—Ä–µ–Ω–∏–µ (NumPy, numba, ProcessPoolExecutor)
8. –¢–µ—Å—Ç—ã –∏ –∫–∞–∫ –∏—Ö –∑–∞–ø—É—Å–∫–∞—Ç—å
9. –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö —á–∏–Ω–∏—Ç—å
10. –ì–ª–æ—Å—Å–∞—Ä–∏–π Python-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –¥–ª—è –Ω–æ–≤–∏—á–∫–∞
11. –ë—ã—Å—Ç—Ä—ã–π —á–µ–∫-–ª–∏—Å—Ç –∑–∞–ø—É—Å–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

## 1) –ß—Ç–æ –¥–µ–ª–∞–µ—Ç Python-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

- –ß–∏—Ç–∞–µ—Ç FASTA —Å –º–∏—Ç–æ—Ö–æ–Ω–¥—Ä–∏–∞–ª—å–Ω–æ–π –î–ù–ö (`data/1_raw/Homo_sapients.mtDNA.fasta`).
- –î–ª—è –∑–∞–¥–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ `pos` –∏ –ø–∞—Ä—ã –∞–ª–ª–µ–ª–µ–π (`ref_nuc` ‚Üí `alt_nuc`) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤—Å–µ –º–æ—Ç–∏–≤—ã (—Å –∞—Å—Å–∏–º–µ—Ç—Ä–∏—á–Ω—ã–º–∏ —Ñ–ª–∞–Ω–∫–∞–º–∏) –∏ –∏—â–µ—Ç –ø–æ—Ö–æ–∂–∏–µ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ –≤–æ –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
- –°—á–∏—Ç–∞–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –•—ç–º–º–∏–Ω–≥–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–π) –º–µ–∂–¥—É –º–æ—Ç–∏–≤–æ–º –∏ –∫–∞–∂–¥—ã–º k-mer.
- –§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–∞–º–æ–ø–æ–≤—Ç–æ—Ä—ã (self-overlaps) –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä—ã (nested), –≤—ã—á–∏—Å–ª—è–µ—Ç `EffectiveLength` = motif_length - hamming_distance.
- –°–æ–∑–¥–∞—ë—Ç CSV-—Ñ–∞–π–ª—ã —Å –ø–æ–ª–Ω—ã–º —Å–ø–∏—Å–∫–æ–º –ø–æ–≤—Ç–æ—Ä–æ–≤ –∏ —Å–≤–æ–¥–∫–æ–π (top-5 –ø–æ EffectiveLength –≤–Ω—É—Ç—Ä–∏ major arc).
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: NumPy-–≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ numba JIT, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á.

---

## 2) –ì–¥–µ –ª–µ–∂–∞—Ç –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã (–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ `python/`)

- `run_compare_pos8473.py` ‚Äî —Å–∫—Ä–∏–ø—Ç-–æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è `pos=8473` –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è Python-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å R.
- `src/analysis.py` ‚Äî –≥–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å: —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –º–æ—Ç–∏–≤–æ–≤, —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, —Ñ–∏–ª—å—Ç—Ä–æ–≤, —Å–±–æ—Ä–∞ —Ç–∞–±–ª–∏—Ü –∏ –∑–∞–ø–∏—Å–∏ CSV.
- `src/io.py` ‚Äî (–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π) —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤, –æ–±—ë—Ä—Ç–∫–∏ –Ω–∞–¥ BioPython `SeqIO` (–µ—Å–ª–∏ –µ—Å—Ç—å).
- `src/main.py` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞/CLI (–µ—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞) –¥–ª—è –æ–±—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞.
- `src/r_integration.py` ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏/—Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å R-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ (—á—Ç–µ–Ω–∏–µ R CSV –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ).
- `src/viz.py` ‚Äî –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π (–∞–Ω–∞–ª–æ–≥ R-—Å–∫—Ä–∏–ø—Ç–∞ —Å ggplot2, –Ω–æ –Ω–∞ Python/Matplotlib/Plotly), —Ä–∏—Å—É–µ—Ç –¥—É–≥–∏ –Ω–∞ –∫—Ä—É–≥–æ–≤–æ–π –∫–∞—Ä—Ç–µ mtDNA.
- `tests/` ‚Äî –Ω–∞–±–æ—Ä unit-—Ç–µ—Å—Ç–æ–≤ (`pytest`) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ–∞–π–ª—ã –≤ `src/` –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–±–æ–ª—å—à–∏–º–∏ helper-–º–æ–¥—É–ª—è–º–∏ ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω –≤ `analysis.py`.

---

## 3) –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–§–∞–π–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: `python/requirements.txt`.

–ü—Ä–∏–º–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ PowerShell (Windows):

```powershell
cd C:\proga\REPEATABILITY\python
python -m venv .venv
.\.venv\Scripts\Activate.ps1
pip install --upgrade pip
pip install -r requirements.txt
```

–ï—Å–ª–∏ –≤ `requirements.txt` –Ω–µ—Ç `biopython`, `numpy`, `pandas` –∏ `pytest`, —É—Å—Ç–∞–Ω–æ–≤–∏ –∏—Ö —è–≤–Ω–æ:

```powershell
pip install biopython numpy pandas pytest numba
```

---

## 4) –ö–ª—é—á–µ–≤—ã–µ –º–æ–¥—É–ª–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî —Ä–∞–∑–±–æ—Ä –ø–æ —Ñ–∞–π–ª–∞–º

–ù–∏–∂–µ ‚Äî —Ñ–∞–π–ª-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ –∫–ª—é—á–µ–≤—ã–º–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º–∏ –ª–æ–≥–∏–∫–∏.

### `run_compare_pos8473.py` ‚Äî –∫—Ä–∞—Ç–∫–æ

- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –±—ã—Å—Ç—Ä—ã–π wrapper –¥–ª—è –∑–∞–ø—É—Å–∫–∞ `analyze_mtDNA_repeats` –∏–∑ `src.analysis` –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤—ã—Ö–æ–¥–æ–≤ —Å —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ R-CSV –≤ `data/2_derived/pos8473_TtoC/`.
- –û—Å–Ω–æ–≤–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
  1. –ù–∞—Ö–æ–¥–∏—Ç –ø—É—Ç—å –∫ `data/1_raw/Homo_sapients.mtDNA.fasta` (–æ–±—ã—á–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞).
  2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `analyze_mtDNA_repeats` –∏–∑ `src.analysis`.
  3. –ó–∞–ø—É—Å–∫–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (pos=8473, ref='T', alt='C', flanks=20, min_length=5, mismatch_percent=0.2, major_arc boundaries).
  4. –ó–∞–≥—Ä—É–∂–∞–µ—Ç R-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (CSV) –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç DataFrame'—ã, –≤—ã–≤–æ–¥–∏—Ç —Ä–∞–∑–ª–∏—á–∏—è.

–ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ:

```powershell
# –ò–∑ –∫–æ—Ä–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
python run_compare_pos8473.py
```

---

### `src/analysis.py` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ (—è–¥—Ä–æ)

–≠—Ç–æ –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª: –∑–¥–µ—Å—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –º–æ—Ç–∏–≤–æ–≤, —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —ç–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

–ö–ª—é—á–µ–≤—ã–µ —á–∞—Å—Ç–∏ (–æ–±—ã—á–Ω–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç; —Å–º. —Ñ–∞–π–ª):

1. –ò–º–ø–æ—Ä—Ç—ã

```python
from pathlib import Path
import pandas as pd
import numpy as np
from Bio import SeqIO  # –∏–ª–∏ from Bio.Seq import Seq
import logging
from concurrent.futures import ProcessPoolExecutor
# optional: import numba
```

–ü–æ—è—Å–Ω–µ–Ω–∏–µ: `pandas` ‚Äî —Ç–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ; `numpy` ‚Äî –±—ã—Å—Ç—Ä—ã–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏; `BioPython` –¥–ª—è —á—Ç–µ–Ω–∏—è FASTA; `ProcessPoolExecutor` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç–∏.

2. –§—É–Ω–∫—Ü–∏—è `get_motif_around_position(seq, pos, left_flank, right_flank)`

- –í—Ö–æ–¥: `seq` –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ (–∏–ª–∏ BioPython Seq), `pos` 1-based (–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π), —Ñ–ª–∞–Ω–∫–∏.
- –î–µ–ª–∞–µ—Ç `start = max(pos - left_flank - 1, 0)` –∏ `end = min(pos + right_flank, len(seq))` (Python 0-based).
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ä–µ–∑ —Å—Ç—Ä–æ–∫–∏ –º–æ—Ç–∏–≤–∞.

3. –§—É–Ω–∫—Ü–∏—è `hamming_distance(a, b)`

- –ü—Ä–æ—Å—Ç–æ–π —Å–∏–º–≤–æ–ª—å–Ω—ã–π –ø–æ–¥—Å—á—ë—Ç: `sum(c1 != c2 for c1, c2 in zip(a, b))`.
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ NumPy (—Å–º. –Ω–∏–∂–µ).

4. –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

- `_seq_to_int_array(seq)`: –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –Ω—É–∫–ª–µ–æ—Ç–∏–¥—ã –≤ –Ω–µ–±–æ–ª—å—à–∏–µ int-–∫–æ–¥—ã (A‚Üí0, C‚Üí1, G‚Üí2, T‚Üí3, N‚Üí4).
- `_sliding_window_view(arr, k)`: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `np.lib.stride_tricks.as_strided` —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É –≤—Å–µ—Ö k-–º–º–µ—Ä–æ–≤ –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ int (–±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö).
- `find_approximate_repeats_np(seq, motif, max_mismatch)`: –¥–µ–ª–∞–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ—Ç–∏–≤–∞ —Å–æ –≤—Å–µ–º–∏ k-–º–º–µ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ –±—É–ª–µ–≤—ã –º–∞—Å—Å–∏–≤—ã –∏ `np.sum(..., axis=1)` –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π ‚Äî —ç—Ç–æ –¥–∞—ë—Ç —Å–µ—Ä—å—ë–∑–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —á–∏—Å—Ç–æ-–ø–∏—Ç–æ–Ω–æ–≤—Å–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π.

5. –§—É–Ω–∫—Ü–∏—è `find_approximate_repeats(seq, motif, max_mismatch, use_numpy=True)`

- –î–∏—Å–ø–µ—Ç—á–µ—Ä: –µ—Å–ª–∏ `use_numpy` –∏ `numpy` –¥–æ—Å—Ç—É–ø–µ–Ω, –≤—ã–∑—ã–≤–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é, –∏–Ω–∞—á–µ –ø–∞–¥–∞–µ—Ç –Ω–∞ –ø—Ä–æ—Å—Ç—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å —Ü–∏–∫–ª–æ–º.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `pandas.DataFrame` —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: `repeat.seq`, `repeat.start`, `repeat.end`, `repeat.hamming.distance`.

6. `get_repeatability_table(seq, pos, ref_nuc, alt_nuc, min_length, max_flank_left, max_flank_right, mismatch_percent, parallel=True)`

- –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª: –¥–ª—è –∫–∞–∂–¥–æ–π –∞–ª–ª–µ–ª–∏ (`ref_nuc`, `alt_nuc`) –¥–µ–ª–∞–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –º–µ–Ω—è–µ—Ç –±—É–∫–≤—É –≤ –ø–æ–∑–∏—Ü–∏–∏), –∑–∞—Ç–µ–º –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –≤—Å–µ –¥–ª–∏–Ω—ã –º–æ—Ç–∏–≤–æ–≤ –∏ –∞—Å—Å–∏–º–µ—Ç—Ä–∏—á–Ω—ã–µ —Ñ–ª–∞–Ω–∫–∏.
- –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∏—Ç –º–æ—Ç–∏–≤, —Å—á–∏—Ç–∞–µ—Ç `max_mismatch_allowed = floor(mismatch_percent * motif_length)` –∏ –≤—ã–∑—ã–≤–∞–µ—Ç `find_approximate_repeats`.
- –°–æ–±–∏—Ä–∞–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä—ã –≤ –æ–±—â–∏–π DataFrame, –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–ª–æ–Ω–∫–∏ `motif.seq`, `motif.length`, `motif.start`, `motif.end`, `pos`, `nuc`, `RefAlt`.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É: —Ä–∞–∑–±–∏–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏ (–∫–∞–∂–¥—ã–π –º–æ—Ç–∏–≤ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞) –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ `ProcessPoolExecutor`.

7. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è: `filter_self_overlaps(df)`

- –£—Å–ª–æ–≤–∏–µ: `df[(df['motif.end'] < df['repeat.start']) | (df['repeat.end'] < df['motif.start'])]` ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã.

8. `compute_effective_length(df)`

- –î–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–ª–æ–Ω–∫—É `EffectiveLength = df['motif.length'] - df['repeat.hamming.distance']`.

9. `remove_nested_repeats(df)`

- –ì—Ä–∏—Ç–µ–¥-–∞–ª–≥–æ—Ä–∏—Ç–º: —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ —É–±—ã–≤–∞–Ω–∏—é `EffectiveLength` –∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∞–ª–ª–µ–ª–∏ —Ö—Ä–∞–Ω–∏—Ç "kept_intervals"; –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –ø–æ–≤—Ç–æ—Ä, –µ—Å–ª–∏ –æ–Ω —Ü–µ–ª–∏–∫–æ–º –≤–Ω—É—Ç—Ä–∏ —É–∂–µ –ø—Ä–∏–Ω—è—Ç–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞.
- –ú–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `intervaltree` –∏–ª–∏ –≤—Ä—É—á–Ω—É—é –≤ —Ü–∏–∫–ª–µ; IRanges –≤ R –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –≤ Python –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –≥—Ä–∞–Ω–∏—Ü.

10. –°–≤–µ–¥–µ–Ω–∏–µ –ø–æ `major arc` –∏ –∑–∞–ø–∏—Å—å CSV

- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `repeat.start >= major_arc_start` –∏ `repeat.end <= major_arc_end`.
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ `RefAlt` –∏ `EffectiveLength`, –ø–æ–¥—Å—á—ë—Ç Count –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ top-5.
- `DataFrame.to_csv()` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è `all_repeats` –∏ `summary_table`.

---

## 5) –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–æ—à–∞–≥–æ–≤—ã–π –ø–∞–π–ø–ª–∞–π–Ω (–∫–∞–∫ –∫–æ–¥ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç)

1. –ß—Ç–µ–Ω–∏–µ FASTA:

```python
from Bio import SeqIO
record = next(SeqIO.parse(fasta_path, "fasta"))
seq = str(record.seq)  # —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
```

2. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–¥–∞—á (–∫–∞–∂–¥—ã–π –º–æ—Ç–∏–≤ ‚Äî –∑–∞–¥–∞—á–∞):
   - –î–ª—è `allele` –≤ `[ref, alt]`:
   - –ï—Å–ª–∏ `allele != ref` ‚Äî —Å–æ–∑–¥–∞—Ç—å –∫–æ–ø–∏—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∑–∞–º–µ–Ω–∏—Ç—å —Å–∏–º–≤–æ–ª –≤ `pos-1`.
   - –î–ª—è `motif_len` –≤ `range(min_length, motif_max_len+1)` –∏ –¥–ª—è `left_flank` –≤ `0..motif_len-1`:
     - –í—ã—á–∏—Å–ª–∏—Ç—å `right_flank = motif_len - left_flank - 1` –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã
     - –ü–æ—Å—Ç—Ä–æ–∏—Ç—å `motif = seq_allele[start:end]` –∏ `max_mismatch_allowed`
     - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥—å

3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

```python
with ProcessPoolExecutor(max_workers=N) as ex:
    results = list(ex.map(_process_task_worker, tasks))
```

4. –°–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –µ–¥–∏–Ω—ã–π `pandas.DataFrame`.

5. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤: self-overlaps, EffectiveLength, remove nested.

6. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ major arc –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ top-5 summary.

7. –ó–∞–ø–∏—Å—å `to_csv()`.

---

## 6) –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ª–æ–≥–∏–∫–∞ (–¥–µ—Ç–∞–ª—å)

- Self-overlap: —É–±–∏—Ä–∞–µ–º –º–æ—Ç–∏–≤—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º –ø–æ–≤—Ç–æ—Ä–æ–º ‚Äî —Ç.–∫. –º–æ—Ç–∏–≤ "–Ω–∞—Ö–æ–¥–∏—Ç —Å–∞–º —Å–µ–±—è".

- EffectiveLength: `motif_length - hamming_distance`. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è: —Å–∫–æ–ª—å–∫–æ –ø–æ–∑–∏—Ü–∏–π –º–æ—Ç–∏–≤–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ–≤–ø–∞–ª–æ.

- Nested removal: —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ EffectiveLength (desc), –∑–∞—Ç–µ–º –∂–∞–¥–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤.

---

## 7) –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è –∏ —É—Å–∫–æ—Ä–µ–Ω–∏–µ

- NumPy-–≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–∞—ë—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –≤—ã–≥–æ–¥—É, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å –æ–¥–∏–Ω –º–æ—Ç–∏–≤ —Å —Ç—ã—Å—è—á–∞–º–∏ k-mer'–æ–≤. –°—Ç—Ä–∞—Ç–µ–≥–∏—è:
  1. –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫—É –≤ `np.uint8` –∏–ª–∏ –º–∞–ª–µ–Ω—å–∫–∏–µ `int` –∫–æ–¥—ã (A,C,G,T‚Üí0..3).
  2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `as_strided` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö k-mer'–æ–≤ –∫–∞–∫ 2D –º–∞—Å—Å–∏–≤–∞.
  3. –°—Ä–∞–≤–Ω–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É —Å –≤–µ–∫—Ç–æ—Ä–æ–º –º–æ—Ç–∏–≤–∞ –∏ –ø–æ—Å—á–∏—Ç–∞—Ç—å –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏—è `np.count_nonzero(mismatch, axis=1)`.

- `numba` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è JIT-—É—Å–∫–æ—Ä–µ–Ω–∏—è —á–∏—Å—Ç–æ-–ø–∏—Ç–æ–Ω—Å–∫–∏—Ö —Ü–∏–∫–ª–æ–≤ (–µ—Å–ª–∏ NumPy-–ø—É—Ç—å –Ω–µ –≤–æ–∑–º–æ–∂–µ–Ω), –Ω–æ —ç—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É –∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å.

- `ProcessPoolExecutor` ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è –ø–æ –∑–∞–¥–∞—á–∞–º (–∫–∞–∂–¥—ã–π –º–æ—Ç–∏–≤ –æ—Ç–¥–µ–ª—å–Ω–æ). –£—á—Ç–∏ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (pickle) ‚Äî –ø–µ—Ä–µ–¥–∞–≤–∞–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

---

## 8) –¢–µ—Å—Ç—ã –∏ –∫–∞–∫ –∏—Ö –∑–∞–ø—É—Å–∫–∞—Ç—å

–í `python/tests/` –ª–µ–∂–∞—Ç —Ç–µ—Å—Ç—ã `pytest` –¥–ª—è –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Å R.

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```powershell
cd C:\proga\REPEATABILITY\python
.\.venv\Scripts\Activate.ps1
pytest -q
```

–ü—Ä–æ–≤–µ—Ä–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
- `test_analysis.py` ‚Äî –±–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π –ø–æ–∏—Å–∫–∞.
- `test_r_python_equivalence.py` ‚Äî —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç CSV, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ R –∏ Python (–≤–∞–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤).

---

## 9) –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö —á–∏–Ω–∏—Ç—å

1) –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è FASTA / –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–Ω `seq`:

```python
from Bio import SeqIO
record = next(SeqIO.parse(fasta_path, 'fasta'))  # —É–±–µ–¥–∏—Å—å, —á—Ç–æ parse –Ω–µ –ø—É—Å—Ç–æ–π
len(str(record.seq))  # –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 16568
```

2) Off-by-one (–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è):
- R –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 1-based –∏–Ω–¥–µ–∫—Å—ã, Python ‚Äî 0-based. –í—Å–µ–≥–¥–∞ –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥–µ –ø–æ–∑–∏—Ü–∏–π –≤—ã—á–∏—Ç–∞–µ–º `1` –¥–ª—è —Å—Ä–µ–∑–æ–≤: `seq[pos-1]`.

3) –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –µ—Å–ª–∏ –ø–æ–∏—Å–∫ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω—ã–π ‚Äî –≤–∫–ª—é—á–∏ `use_numpy=True` –∏–ª–∏ —É–±–µ–¥–∏—Å—å, —á—Ç–æ NumPy –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω.

4) –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–æ–º: —É–±–µ–¥–∏—Å—å, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ (–≤ –º–æ–¥—É–ª–µ), –∏–Ω–∞—á–µ `ProcessPoolExecutor` –Ω–µ —Å–º–æ–∂–µ—Ç –∏—Ö —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å.

5) –ù–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (`N`, –ø—Ä–æ–±–µ–ª—ã): –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥–µ –≤ int-–∫–æ–¥—ã –¥–æ–±–∞–≤—å —É—Å–ª–æ–≤–∏–µ –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ (map to 4) –∏ –ø—Ä–æ–ø—É—Å–∫–∞–π —Ç–∞–∫–∏–µ k-mer'—ã –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ.

---

## 10) –ì–ª–æ—Å—Å–∞—Ä–∏–π Python-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ (–¥–ª—è –Ω–æ–≤–∏—á–∫–∞)

- `def func(arg1, arg2=3):` ‚Äî –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏; `arg2` –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
- `if x:` ‚Äî —É—Å–ª–æ–≤–∏–µ (–±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ, –µ—Å–ª–∏ `x` –Ω–µ –ø—É—Å—Ç–æ –∏ –Ω–µ –Ω–æ–ª—å).
- `for i in range(10):` ‚Äî —Ü–∏–∫–ª (0..9).
- `list_comprehension = [x*x for x in range(5)]` ‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å —Å–ø–∏—Å–∫–∞.
- `with open(path) as f:` ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏ (–∑–∞–∫—Ä—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).
- `import module as mod` ‚Äî –∏–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è —Å –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–º.
- `pd.DataFrame(...)` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã pandas.
- `df.merge(df2, on='key', how='outer', indicator=True)` ‚Äî —Å–ª–∏—è–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è.

---

## 11) –ë—ã—Å—Ç—Ä—ã–π —á–µ–∫-–ª–∏—Å—Ç –∑–∞–ø—É—Å–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

1. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—Å–º. —Ä–∞–∑–¥–µ–ª 3).
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ FASTA: `data/1_raw/Homo_sapients.mtDNA.fasta`.
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å `run_compare_pos8473.py`:

```powershell
cd C:\proga\REPEATABILITY\python
python run_compare_pos8473.py
```

4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

```powershell
Test-Path .\pos8473_TtoC\my_mtDNA_repeat_all_repeats.csv
Test-Path .\pos8473_TtoC\my_mtDNA_repeat_major_arc_summary_top5.csv
```

5. –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤:

```powershell
pytest -q
```

---

## –î–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –¥–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ docstrings –≤ `src/analysis.py` –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç ‚Äî —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å.
- –í—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (major_arc_start/end, mismatch_percent, flanks) –≤ –≤–Ω–µ—à–Ω–∏–π `yaml`/`json` —Ñ–∞–π–ª.
- –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `--dry-run` –∏–ª–∏ `--max-tasks` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –º–∞–ª–æ–º –æ–±—ä—ë–º–µ.
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `intervaltree` (pip install intervaltree) –¥–ª—è –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ –≤ Python.

---

–§–∞–π–ª —Å–æ–∑–¥–∞–Ω: `c:\proga\REPEATABILITY\DETAILED_PYTHON_SCRIPT_TODO.md`

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É:
- –∑–∞–ø—É—Å—Ç–∏—Ç—å `pytest` –∏ –ø—Ä–∏—Å–ª–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥),
- –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä—è–º—ã–µ –≤—Å—Ç–∞–≤–∫–∏ –∫–ª—é—á–µ–≤—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –∫–æ–¥–∞ –∏–∑ `src/analysis.py` (line-by-line) ‚Äî —è –º–æ–≥—É –ø–æ—á–∏—Ç–∞—Ç—å –∏ –≤—Å—Ç—Ä–æ–∏—Ç—å –ø–æ—è—Å–Ω–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤,
- —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∞—Ç–∫–∏–π `README_python.md` —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ –∑–∞–ø—É—Å–∫–∞ –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏.

–ß—Ç–æ –¥–µ–ª–∞–µ–º –¥–∞–ª—å—à–µ?